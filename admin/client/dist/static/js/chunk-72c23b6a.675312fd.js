(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72c23b6a"],{a434:function(t,e,i){"use strict";var a=i("23e7"),l=i("23cb"),n=i("a691"),s=i("50c4"),r=i("7b0b"),o=i("65f0"),c=i("8418"),u=i("1dde"),m=i("ae40"),d=u("splice"),p=m("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,b=Math.min,h=9007199254740991,g="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!d||!p},{splice:function(t,e){var i,a,u,m,d,p,_=r(this),v=s(_.length),y=l(t,v),w=arguments.length;if(0===w?i=a=0:1===w?(i=0,a=v-y):(i=w-2,a=b(f(n(e),0),v-y)),v+i-a>h)throw TypeError(g);for(u=o(_,a),m=0;m<a;m++)d=y+m,d in _&&c(u,m,_[d]);if(u.length=a,i<a){for(m=y;m<v-a;m++)d=m+a,p=m+i,d in _?_[p]=_[d]:delete _[p];for(m=v;m>v-a+i;m--)delete _[m-1]}else if(i>a)for(m=v-a;m>y;m--)d=m+a-1,p=m+i-1,d in _?_[p]=_[d]:delete _[p];for(m=0;m<i;m++)_[m+y]=arguments[m+2];return _.length=v-a+i,u}})},aab4:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[e("el-button",{attrs:{type:"primary"},on:{click:t.handleAddEmail}},[t._v("新建邮件")]),e("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:t.emailsList,border:""}},[e("el-table-column",{attrs:{align:"center",label:"标题",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.title)+" ")]}}])}),e("el-table-column",{attrs:{align:"center",label:"内容",width:"600"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.content)+" ")]}}])}),e("el-table-column",{attrs:{align:"center",label:"奖励道具",width:"350"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-table",{staticStyle:{width:"100%"},attrs:{data:i.row.item_list}},[e("el-table-column",{staticStyle:{width:"50%"},attrs:{align:"center",label:"道具名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.getItemName(e.row.id))+" ")]}}],null,!0)}),e("el-table-column",{staticStyle:{width:"50%"},attrs:{align:"center",label:"道具数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.count)+" ")]}}],null,!0)})],1)]}}])}),e("el-table-column",{attrs:{align:"center",label:"有效时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(i){return[0==i.row.vaild_time?e("p",[t._v("永久")]):e("p",[t._v(t._s(new Date(i.row.vaild_time).toLocaleString("zh-CN")))])]}}])}),e("el-table-column",{attrs:{align:"center",label:"操作项"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleEdit(i)}}},[t._v("修改")]),e("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){return t.handleDelete(i)}}},[t._v("删除")])]}}])})],1),e("el-dialog",{attrs:{visible:t.dialogVisible,title:"edit"===t.dialogType?"编辑邮件":"修改邮件"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{attrs:{model:t.email,"label-width":"80px","label-position":"left"}},[e("el-form-item",{attrs:{label:"标题"}},[e("el-input",{attrs:{placeholder:"标题"},model:{value:t.email.title,callback:function(e){t.$set(t.email,"title",e)},expression:"email.title"}})],1),e("el-form-item",{attrs:{label:"内容"}},[e("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"内容"},model:{value:t.email.content,callback:function(e){t.$set(t.email,"content",e)},expression:"email.content"}})],1),e("el-form-item",{attrs:{label:"奖励道具"}},[e("el-button",{staticStyle:{width:"30%"},attrs:{type:"primary"},on:{click:t.handleAddItem}},[t._v("增加道具奖励")]),e("el-select",{staticStyle:{width:"30%"},attrs:{placeholder:"请选择道具名称"},model:{value:t.optItem,callback:function(e){t.optItem=e},expression:"optItem"}},t._l(t.itemsList,(function(t){return e("el-option",{key:t.item_id,attrs:{label:t.item_name,value:t.item_id}})})),1),e("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"道具数量"},model:{value:t.optItemCount,callback:function(e){t.optItemCount=e},expression:"optItemCount"}}),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.email.item_list}},[e("el-table-column",{staticStyle:{width:"30%"},attrs:{align:"center",label:"道具名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.getItemName(e.row.id))+" ")]}}])}),e("el-table-column",{staticStyle:{width:"30%"},attrs:{align:"center",label:"道具数据"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-input",{model:{value:i.row.count,callback:function(e){t.$set(i.row,"count",e)},expression:"oneItem.row.count"}},[t._v(" "+t._s(i.row.count)+" ")])]}}])}),e("el-table-column",{attrs:{align:"center",label:"操作项"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){return t.handleDeleteItem(i.row.id)}}},[t._v("删除")])]}}])})],1)],1),e("el-form-item",{attrs:{label:"有效时间"}},[0==t.email.vaild_time?e("p",[t._v("永久")]):e("p",[t._v(t._s(new Date(t.email.vaild_time).toLocaleString("zh-CN")))]),e("el-date-picker",{attrs:{type:"datetime","value-format":"timestamp",placeholder:"选择日期"},model:{value:t.email.vaild_time,callback:function(e){t.$set(t.email,"vaild_time",e)},expression:"email.vaild_time"}}),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.changeForEverVaildTime}},[t._v("永久")])],1)],1),e("div",{staticStyle:{"text-align":"right"}},[e("el-button",{attrs:{type:"danger"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.confirmEmail}},[t._v("提交")])],1)],1)],1)},l=[],n=i("c7eb"),s=i("1da1"),r=(i("a434"),i("b775"));function o(){return Object(r["a"])({url:"/global_email/list",method:"get"})}function c(t){return Object(r["a"])({url:"/global_email/add",method:"post",data:t})}function u(t){return Object(r["a"])({url:"/global_email/update/".concat(t.guid),method:"put",data:t})}function m(t){return Object(r["a"])({url:"/global_email/del/".concat(t),method:"delete"})}function d(){return Object(r["a"])({url:"global_email/itemList",method:"get"})}var p=i("5c96"),f={guid:0,title:"",content:"",item_list:[],vaild_time:0},b={data:function(){return{emailsList:[],dialogVisible:!1,dialogType:"new",email:Object.assign({},f),itemsList:[],itemsMap:{},optItem:null,optItemCount:null}},created:function(){this.getEmailList(),this.getItemsList()},methods:{getEmailList:function(){var t=this;return Object(s["a"])(Object(n["a"])().mark((function e(){var i,a,l;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:for(i=e.sent,console.log("getEmailList >>> ",i.data),Array.isArray(i.data)?t.emailsList=i.data:t.emailsList=[],a=0;a<t.emailsList.length;a++)l=t.emailsList[a],l.vaild_time=1e3*l.vaild_time,Array.isArray(l.item_list)||(l.item_list=[]);case 6:case"end":return e.stop()}}),e)})))()},getItemsList:function(){var t=this;return Object(s["a"])(Object(n["a"])().mark((function e(){var i,a,l;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:for(i=e.sent,Array.isArray(i.data)?t.itemsList=i.data:t.itemsList=[],t.itemsMap={},a=0;a<t.itemsList.length;a++)l=t.itemsList[a],t.itemsMap[l.item_id]=l;console.log("getItemsList >>> ",t.itemsList,t.itemsMap);case 7:case"end":return e.stop()}}),e)})))()},getItemName:function(t){return this.itemsMap[t]?this.itemsMap[t].item_name:"未知道具:"+t},handleAddEmail:function(){this.email=Object.assign({},f),this.dialogType="new",this.dialogVisible=!0},handleEdit:function(t){this.email=t.row,this.dialogType="edit",this.dialogVisible=!0},handleDelete:function(t){var e=this;return Object(s["a"])(Object(n["a"])().mark((function i(){var a,l,s;return Object(n["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.dialogVisible=!1,a=t.row,l=a.guid,i.next=5,m(l);case 5:s=i.sent,"succ"==s.data&&e.$notify({title:"删除邮件成功，请稍后刷新界面",dangerouslyUseHTMLString:!0,message:"\n                        <div>email title: ".concat(e.email.title,"</div>\n                    "),type:"成功"});case 7:case"end":return i.stop()}}),i)})))()},confirmEmail:function(){var t=this;return Object(s["a"])(Object(n["a"])().mark((function e(){var i,a,l;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i="edit"===t.dialogType,t.dialogVisible=!1,console.log("confirmEmail:",t.email),t.email.vaild_time=Math.floor(t.email.vaild_time/1e3),i){e.next=11;break}return e.next=7,c(t.email);case 7:a=e.sent,"succ"==a.data&&t.$notify({title:"新增邮件成功，请稍后刷新界面",dangerouslyUseHTMLString:!0,message:"\n                            <div>email title: ".concat(t.email.title,"</div>\n                        "),type:"成功"}),e.next=15;break;case 11:return e.next=13,u(t.email);case 13:l=e.sent,"succ"==l.data&&t.$notify({title:"修改邮件成功",dangerouslyUseHTMLString:!0,message:"\n                            <div>email title: ".concat(t.email.title,"</div>\n                        "),type:"成功"});case 15:case"end":return e.stop()}}),e)})))()},handleDeleteItem:function(t){for(var e=0;e<this.email.item_list.length;e++){var i=this.email.item_list[e];if(i.id==t){this.email.item_list.splice(e,1);break}}},handleAddItem:function(){this.optItem?this.optItemCount?this.optItemCount<=0?Object(p["Message"])({message:"道具数量必须大于0",type:"error",duration:5e3}):this.email.item_list.push({id:this.optItem,count:this.optItemCount}):Object(p["Message"])({message:"请输入道具数量",type:"error",duration:5e3}):Object(p["Message"])({message:"请选择道具名称",type:"error",duration:5e3})},changeForEverVaildTime:function(){this.email.vaild_time=0}}},h=b,g=i("2877"),_=Object(g["a"])(h,a,l,!1,null,null,null);e["default"]=_.exports}}]);